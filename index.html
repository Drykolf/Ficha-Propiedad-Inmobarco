<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UT    <!-- Load external scripts -->
    <script src="../utils.js"></script>
    <script src="js/arrendasoft-api.js"></script>
    
    <script>
        // Initialize when DOM is loaded - the API module will handle everything
        // Additional initialization can be added here if needed
        
        document.addEventListener('DOMContentLoaded', async () => {
            const loadingElement = document.getElementById('loading');
            const errorElement = document.getElementById('error');
            const contentElement = document.getElementById('property-content');
            
            try {
                console.log('üöÄ Initializing application...');
                
                // Load configuration using environment-aware config loader
                await window.envConfig.loadConfig();
                const apiConfig = window.envConfig.getApiConfig();
                
                console.log('üìã Configuration loaded:', {
                    hasBaseUrl: !!apiConfig?.baseUrl,
                    hasToken: !!apiConfig?.token,
                    instance: apiConfig?.instance
                });
                
                if (!apiConfig) {
                    throw new Error('No se pudo cargar la configuraci√≥n de la API');
                }
                
                if (!apiConfig.token) {
                    throw new Error('Token de API no encontrado en la configuraci√≥n');
                }

                // Create global controller instance
                window.propertyController = new PropertyDetailController(apiConfig);

                // Initialize the property detail page
                window.propertyController.init();
            
            // Add any additional initialization logic here
            console.log('üè† Inmobarco Property Template loaded successfully');
            
            // Enable debug mode in development
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log('üîß Development mode detected');
                console.log('üí° Use window.debugAPI for debugging helpers');
            }
            } catch (error) {
                console.error('‚ùå Error during initialization:', error);
                
                // Hide loading, show error
                if (loadingElement) loadingElement.style.display = 'none';
                if (errorElement) {
                    errorElement.style.display = 'block';
                    errorElement.innerHTML = `
                        <h3>Error al cargar la aplicaci√≥n</h3>
                        <p><strong>Detalle:</strong> ${error.message}</p>
                        <p><strong>Posibles causas:</strong></p>
                        <ul>
                            <li>Variables de entorno no configuradas correctamente en Netlify</li>
                            <li>Token de API inv√°lido o expirado</li>
                            <li>Problema de conectividad</li>
                        </ul>
                        <p>Por favor, verifica la configuraci√≥n e int√©ntalo de nuevo.</p>
                        <button onclick="window.location.reload()" style="margin-top: 10px; padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            Reintentar
                        </button>
                    `;
                }
                
                // Log environment info for debugging
                console.log('üîç Debug info:', {
                    hostname: window.location.hostname,
                    isProduction: window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1',
                    hasENV: !!window.ENV,
                    envKeys: window.ENV ? Object.keys(window.ENV) : 'No ENV object'
                });
            }
        });
    </script><!--e="viewport" content="width=device-width, initial-scale=1.0">-->
    <title>Detalles de Propiedad - Inmobarco</title>
    <meta name="description" content="Encuentra la propiedad perfecta en Inmobarco. Propiedades en venta y arriendo con la mejor ubicaci√≥n y precios.">
    <meta name="keywords" content="inmuebles, propiedades, venta, arriendo, Inmobarco">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:title" content="Detalles de Propiedad - Inmobarco">
    <meta property="og:description" content="Encuentra la propiedad perfecta en Inmobarco">
    <meta property="og:image" content="">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="">
    <meta property="twitter:title" content="Detalles de Propiedad - Inmobarco">
    <meta property="twitter:description" content="Encuentra la propiedad perfecta en Inmobarco">
    <meta property="twitter:image" content="">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/property-detail-styles.css">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="js/arrendasoft-api.js" as="script">
    
    <!-- Structured Data -->
    <script type="application/ld+json" id="property-schema">
    {
        "@context": "http://schema.org",
        "@type": "RealEstate",
        "name": "Propiedad en Inmobarco",
        "provider": {
            "@type": "Organization",
            "name": "Inmobarco",
            "url": "https://inmobarco.com"
        }
    }
    </script>
</head>
<body>
    <!-- Header con Logo -->
    <header class="property-header-with-logo">
        <div class="header-content">
            <div class="logo-section">
                <img src="assets/images/Logo.png" alt="Inmobarco - Inmobiliaria" class="logo-inmobarco">
                <div class="header-title-section">
                    <h1 class="header-main-title">Detalles de Propiedad</h1>
                    <p class="header-subtitle">Encuentra tu hogar ideal</p>
                </div>
            </div>
            <div class="company-info">
                <p class="company-tagline">Tu hogar ideal te est√° esperando</p>
                <p class="company-contact">www.inmobarco.com</p>
            </div>
        </div>
    </header>

    <div class="container">
        <div id="loading" class="loading">
            Cargando detalles de la propiedad...
        </div>

        <div id="error" class="error" style="display: none;">
            Error al cargar la propiedad. Por favor, int√©ntelo de nuevo m√°s tarde.
        </div>

        <div id="property-content" style="display: none;">
            <!-- Property content will be loaded here -->
        </div>
    </div>

    <!-- Load external scripts -->
    <script src="js/env-vars.js"></script>
    <script src="js/env-config.js"></script>
    <script src="js/secure-config.js"></script>
    <script src="js/arrendasoft-api.js"></script>
    
    <script>
        // Initialize when DOM is loaded - the API module will handle everything
        // Additional initialization can be added here if needed
        
        document.addEventListener('DOMContentLoaded', () => {
            // Add any additional initialization logic here
            console.log('üè† Inmobarco Property Template loaded successfully');
            
            // Enable debug mode in development
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log('üîß Development mode detected');
                console.log('üí° Use window.debugAPI for debugging helpers');
            }
        });
    </script>
</body>
</html>